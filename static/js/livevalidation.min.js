var LiveValidation=function(b,a){this.initialize(b,a)};LiveValidation.VERSION="1.3 standalone";LiveValidation.TEXTAREA=1;LiveValidation.TEXT=2;LiveValidation.PASSWORD=3;LiveValidation.CHECKBOX=4;LiveValidation.SELECT=5;LiveValidation.FILE=6;LiveValidation.massValidate=function(b){for(var a=!0,c=0,d=b.length;c<d;++c){var e=b[c].validate();a&&(a=e)}return a}; LiveValidation.prototype={validClass:"LV_valid",invalidClass:"LV_invalid",messageClass:"LV_validation_message",validFieldClass:"LV_valid_field",invalidFieldClass:"LV_invalid_field",initialize:function(b,a){var c=this;if(!b)throw Error("LiveValidation::initialize - No se han referenciado elementos!");this.element=b.nodeName?b:document.getElementById(b);if(!this.element)throw Error("LiveValidation::initialize - No existe el elemento '"+b);this.validations=[];this.elementType=this.getElementType();this.form= this.element.form;var d=a||{};this.validMessage=d.validMessage||"";var e=d.insertAfterWhatNode||this.element;this.insertAfterWhatNode=e.nodeType?e:document.getElementById(e);this.onValid=d.onValid||function(){this.insertMessage(this.createMessageSpan());this.addFieldClass()};this.onInvalid=d.onInvalid||function(){this.insertMessage(this.createMessageSpan());this.addFieldClass()};this.onlyOnBlur=d.onlyOnBlur||!1;this.wait=d.wait||0;this.onlyOnSubmit=d.onlyOnSubmit||!1;this.form&&(this.formObj=LiveValidationForm.getInstance(this.form), this.formObj.addField(this));this.oldOnFocus=this.element.onfocus||function(){};this.oldOnBlur=this.element.onblur||function(){};this.oldOnClick=this.element.onclick||function(){};this.oldOnChange=this.element.onchange||function(){};this.oldOnKeyup=this.element.onkeyup||function(){};this.element.onfocus=function(a){c.doOnFocus(a);return c.oldOnFocus.call(this,a)};if(!this.onlyOnSubmit)switch(this.elementType){case LiveValidation.CHECKBOX:this.element.onclick=function(a){c.validate();return c.oldOnClick.call(this, a)};case LiveValidation.SELECT:case LiveValidation.FILE:this.element.onchange=function(a){c.validate();return c.oldOnChange.call(this,a)};break;default:this.onlyOnBlur||(this.element.onkeyup=function(a){c.deferValidation();return c.oldOnKeyup.call(this,a)}),this.element.onblur=function(a){c.doOnBlur(a);return c.oldOnBlur.call(this,a)}}},destroy:function(){this.formObj&&(this.formObj.removeField(this),this.formObj.destroy());this.element.onfocus=this.oldOnFocus;if(!this.onlyOnSubmit)switch(this.elementType){case LiveValidation.CHECKBOX:this.element.onclick= this.oldOnClick;case LiveValidation.SELECT:case LiveValidation.FILE:this.element.onchange=this.oldOnChange;break;default:this.onlyOnBlur||(this.element.onkeyup=this.oldOnKeyup),this.element.onblur=this.oldOnBlur}this.validations=[];this.removeMessageAndFieldClass()},add:function(b,a){this.validations.push({type:b,params:a||{}});return this},remove:function(b,a){for(var c=!1,d=0,e=this.validations.length;d<e;d++)if(this.validations[d].type==b&&this.validations[d].params==a){c=!0;break}c&&this.validations.splice(d, 1);return this},deferValidation:function(){300<=this.wait&&this.removeMessageAndFieldClass();var b=this;this.timeout&&clearTimeout(b.timeout);this.timeout=setTimeout(function(){b.validate()},b.wait)},doOnBlur:function(b){this.focused=!1;this.validate(b)},doOnFocus:function(){this.focused=!0;this.removeMessageAndFieldClass()},getElementType:function(){switch(!0){case "TEXTAREA"==this.element.nodeName.toUpperCase():return LiveValidation.TEXTAREA;case "INPUT"==this.element.nodeName.toUpperCase()&&"TEXT"== this.element.type.toUpperCase():return LiveValidation.TEXT;case "INPUT"==this.element.nodeName.toUpperCase()&&"PASSWORD"==this.element.type.toUpperCase():return LiveValidation.PASSWORD;case "INPUT"==this.element.nodeName.toUpperCase()&&"CHECKBOX"==this.element.type.toUpperCase():return LiveValidation.CHECKBOX;case "INPUT"==this.element.nodeName.toUpperCase()&&"FILE"==this.element.type.toUpperCase():return LiveValidation.FILE;case "SELECT"==this.element.nodeName.toUpperCase():return LiveValidation.SELECT; case "INPUT"==this.element.nodeName.toUpperCase():throw Error("LiveValidation::getElementType - No se puede usar LiveValidation en entrada "+this.element.type);default:throw Error("LiveValidation::getElementType - El elemento debe ser TEXT, SELECT, o TEXTAREA!");}},doValidations:function(){this.validationFailed=!1;for(var b=0,a=this.validations.length;b<a;++b){var c=this.validations[b];switch(c.type){case Validate.Presence:case Validate.Confirmation:case Validate.Acceptance:this.displayMessageWhenEmpty= !0;this.validationFailed=!this.validateElement(c.type,c.params);break;default:this.validationFailed=!this.validateElement(c.type,c.params)}if(this.validationFailed)return!1}this.message=this.validMessage;return!0},validateElement:function(b,a){var c=this.elementType==LiveValidation.SELECT?this.element.options[this.element.selectedIndex].value:this.element.value;if(b==Validate.Acceptance){if(this.elementType!=LiveValidation.CHECKBOX)throw Error("LiveValidation::validateElement - Elemento a validar debe ser checkbox!"); c=this.element.checked}var d=!0;try{b(c,a)}catch(e){if(e instanceof Validate.Error){if(""!==c||""===c&&this.displayMessageWhenEmpty)this.validationFailed=!0,this.message=e.message,d=!1}else throw e;}finally{return d}},validate:function(){if(this.element.disabled)return!0;if(this.doValidations())return this.onValid(),!0;this.onInvalid();return!1},enable:function(){this.element.disabled=!1;return this},disable:function(){this.element.disabled=!0;this.removeMessageAndFieldClass();return this},createMessageSpan:function(){var b= document.createElement("span"),a=document.createTextNode(this.message);b.appendChild(a);return b},insertMessage:function(b){this.removeMessage();if(this.displayMessageWhenEmpty&&(this.elementType==LiveValidation.CHECKBOX||""==this.element.value)||""!=this.element.value)b.className+=" "+this.messageClass+" "+(this.validationFailed?this.invalidClass:this.validClass),this.insertAfterWhatNode.nextSibling?this.insertAfterWhatNode.parentNode.insertBefore(b,this.insertAfterWhatNode.nextSibling):this.insertAfterWhatNode.parentNode.appendChild(b)}, addFieldClass:function(){this.removeFieldClass();if(this.validationFailed)-1==this.element.className.indexOf(this.invalidFieldClass)&&(this.element.className+=" "+this.invalidFieldClass);else if((this.displayMessageWhenEmpty||""!=this.element.value)&&-1==this.element.className.indexOf(this.validFieldClass))this.element.className+=" "+this.validFieldClass},removeMessage:function(){for(var b,a=this.insertAfterWhatNode;a.nextSibling;){if(1===a.nextSibling.nodeType){b=a.nextSibling;break}a=a.nextSibling}b&& -1!=b.className.indexOf(this.messageClass)&&this.insertAfterWhatNode.parentNode.removeChild(b)},removeFieldClass:function(){-1!=this.element.className.indexOf(this.invalidFieldClass)&&(this.element.className=this.element.className.split(this.invalidFieldClass).join(""));-1!=this.element.className.indexOf(this.validFieldClass)&&(this.element.className=this.element.className.split(this.validFieldClass).join(" "))},removeMessageAndFieldClass:function(){this.removeMessage();this.removeFieldClass()}}; var LiveValidationForm=function(b){this.initialize(b)};LiveValidationForm.instances={};LiveValidationForm.getInstance=function(b){var a=Math.random()*Math.random();b.id||(b.id="formId_"+a.toString().replace(/\./,"")+(new Date).valueOf());LiveValidationForm.instances[b.id]||(LiveValidationForm.instances[b.id]=new LiveValidationForm(b));return LiveValidationForm.instances[b.id]}; LiveValidationForm.prototype={initialize:function(b){this.name=b.id;this.element=b;this.fields=[];this.oldOnSubmit=this.element.onsubmit||function(){};var a=this;this.element.onsubmit=function(b){return LiveValidation.massValidate(a.fields)?!1!==a.oldOnSubmit.call(this,b||window.event):!1}},addField:function(b){this.fields.push(b)},removeField:function(b){for(var a=[],c=0,d=this.fields.length;c<d;c++)this.fields[c]!==b&&a.push(this.fields[c]);this.fields=a},destroy:function(b){if(0!=this.fields.length&& !b)return!1;this.element.onsubmit=this.oldOnSubmit;LiveValidationForm.instances[this.name]=null;return!0}}; var Validate={Presence:function(b,a){var a=a||{},c=a.failureMessage||"Campo Obligatorio!";(""===b||null===b||void 0===b)&&Validate.fail(c);return!0},Numericality:function(b,a){var c=b,b=Number(b),a=a||{},d=a.minimum||0==a.minimum?a.minimum:null,e=a.maximum||0==a.maximum?a.maximum:null,f=a.is||0==a.is?a.is:null,g=a.notANumberMessage||"Solo N\u00fameros!",h=a.notAnIntegerMessage||"Debe ser Entero!",k=a.wrongNumberMessage||"Debe ser "+f+"!",i=a.tooLowMessage||"No puede ser menor a "+d+"!",j=a.tooHighMessage|| "No puede ser mayor a "+e+"!";isFinite(b)||Validate.fail(g);a.onlyInteger&&(/\.0+$|\.$/.test(String(c))||b!=parseInt(b))&&Validate.fail(h);switch(!0){case null!==f:b!=Number(f)&&Validate.fail(k);break;case null!==d&&null!==e:Validate.Numericality(b,{tooLowMessage:i,minimum:d});Validate.Numericality(b,{tooHighMessage:j,maximum:e});break;case null!==d:b<Number(d)&&Validate.fail(i);break;case null!==e:b>Number(e)&&Validate.fail(j)}return!0},Format:function(b,a){var b=String(b),a=a||{},c=a.failureMessage|| "No es V\u00e1lido!",d=a.pattern||/./,e=a.negate||!1;!e&&!d.test(b)&&Validate.fail(c);e&&d.test(b)&&Validate.fail(c);return!0},Email:function(b,a){a=a||{};Validate.Format(b,{failureMessage:a.failureMessage||"Debe ser direccion de email valida!",pattern:/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i});return!0},Length:function(b,a){var b=String(b),a=a||{},c=a.minimum||0==a.minimum?a.minimum:null,d=a.maximum||0==a.maximum?a.maximum:null,e=a.is||0==a.is?a.is:null,f=a.wrongLengthMessage||"Debe tener "+e+ " caracteres!",g=a.tooShortMessage||"No debe tener menos de "+c+" caracteres!",h=a.tooLongMessage||"No debe tener mas de "+d+" caracteres!";switch(!0){case null!==e:b.length!=Number(e)&&Validate.fail(f);break;case null!==c&&null!==d:Validate.Length(b,{tooShortMessage:g,minimum:c});Validate.Length(b,{tooLongMessage:h,maximum:d});break;case null!==c:b.length<Number(c)&&Validate.fail(g);break;case null!==d:b.length>Number(d)&&Validate.fail(h);break;default:throw Error("Validate::Debe indicar el largo a Validar!"); }return!0},Inclusion:function(b,a){var a=a||{},c=a.failureMessage||"Debe ser incluido en la lista!",d=!1===a.caseSensitive?!1:!0;if(a.allowNull&&null==b)return!0;!a.allowNull&&null==b&&Validate.fail(c);var e=a.within||[];if(!d){for(var f=[],g=0,d=e.length;g<d;++g){var h=e[g];"string"==typeof h&&(h=h.toLowerCase());f.push(h)}e=f;"string"==typeof b&&(b=b.toLowerCase())}f=!1;g=0;for(d=e.length;g<d;++g)e[g]==b&&(f=!0),a.partialMatch&&-1!=b.indexOf(e[g])&&(f=!0);(!a.negate&&!f||a.negate&&f)&&Validate.fail(c); return!0},Exclusion:function(b,a){a=a||{};a.failureMessage=a.failureMessage||"No debe ser incluido en la lista!";a.negate=!0;Validate.Inclusion(b,a);return!0},Confirmation:function(b,a){if(!a.match)throw Error("Validate::Confirmation - Confirmacion de Error de validacion: Id del elemento a buscar debe ser provisto!");var a=a||{},c=a.failureMessage||"No coinciden!",d=a.match.nodeName?a.match:document.getElementById(a.match);if(!d)throw Error("Validate::Confirmation - No hay referencias con el nombre o elementos con id '"+ a.match+"'!");b!=d.value&&Validate.fail(c);return!0},Acceptance:function(b,a){var a=a||{},c=a.failureMessage||"Debe ser aceptado!";b||Validate.fail(c);return!0},Custom:function(b,a){var a=a||{},c=a.failureMessage||"No es valido!";(a.against||function(){return!0})(b,a.args||{})||Validate.fail(c);return!0},now:function(b,a,c){if(!b)throw Error("Validate::now - Debe indicar funcion de Validacion!");var d=!0;try{b(a,c||{})}catch(e){if(e instanceof Validate.Error)d=!1;else throw e;}finally{return d}}, fail:function(b){throw new Validate.Error(b);},Error:function(b){this.message=b;this.name="ValidationError"}};
